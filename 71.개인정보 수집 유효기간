#include <string>
#include <vector>
#include <sstream>
#include <unordered_map>

using namespace std;

int convertDateToDays(const string& date) {
    int y, m, d;
    sscanf(date.c_str(), "%d.%d.%d", &y, &m, &d);
    return (y * 12 * 28) + (m * 28) + d;
}

vector<int> solution(string today, vector<string> terms, vector<string> privacies) {
    vector<int> answer;
    unordered_map<string, int> termMap;

    // 약관 종류 -> 개월 수 맵핑
    for (auto& t : terms) {
        string type;
        int month;
        stringstream ss(t);
        ss >> type >> month;
        termMap[type] = month;
    }

    int todayValue = convertDateToDays(today);

    for (int i = 0; i < privacies.size(); i++) {
        string date, type;
        stringstream ss(privacies[i]);
        ss >> date >> type;

        int start = convertDateToDays(date);
        int expire = start + (termMap[type] * 28) - 1;  // 보관 가능한 마지막 날

        if (expire < todayValue) {
            answer.push_back(i + 1);  // 번호는 1부터 시작
        }
    }

    return answer;
}
